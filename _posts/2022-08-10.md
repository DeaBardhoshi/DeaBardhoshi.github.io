---
title: 'Blog Post number 2'
date: 2021-05-28
permalink: /posts/2022/08/Michelin Star/
tags:
  - cool posts
---
```python
import osmnx as ox
```

    /opt/anaconda3/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
      warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"



```python
import pandas as pd
import seaborn as sns
import numpy as np
import matplotlib.pyplot as plt
import geopandas as gpd
import contextily as cx
from currency_converter import CurrencyConverter
```


```python
michelin = pd.read_csv('michelin_my_maps.csv')
cities = pd.read_csv('worldcities.csv')
#city_boundaries = gpd.read_file('cities.geojson')
tokyo = gpd.read_file('tokyo.geojson')
```

### Cuisines


```python
# cuisines
```


```python
michelin.groupby('Cuisine', as_index=False).count()[['Cuisine', 'Name']].sort_values('Name', ascending = False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cuisine</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>524</th>
      <td>Modern Cuisine</td>
      <td>1009</td>
    </tr>
    <tr>
      <th>198</th>
      <td>Creative</td>
      <td>435</td>
    </tr>
    <tr>
      <th>411</th>
      <td>Japanese</td>
      <td>290</td>
    </tr>
    <tr>
      <th>768</th>
      <td>Traditional Cuisine</td>
      <td>232</td>
    </tr>
    <tr>
      <th>281</th>
      <td>French</td>
      <td>175</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Cuisine from Romagna, Market Cuisine</td>
      <td>1</td>
    </tr>
    <tr>
      <th>511</th>
      <td>Mexican, Californian</td>
      <td>1</td>
    </tr>
    <tr>
      <th>251</th>
      <td>Cuisine from South West France, Country cooking</td>
      <td>1</td>
    </tr>
    <tr>
      <th>252</th>
      <td>Cuisine from Valtellina, Mediterranean Cuisine</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Afghan</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>825 rows Ã— 2 columns</p>
</div>




```python
michelin[michelin['Cuisine'] == 'Modern Cuisine'].head(1)['Url']
```




    6    https://guide.michelin.com/en/stockholm-region...
    Name: Url, dtype: object




```python
michelin[michelin['Cuisine'] == 'Modern Cuisine'].sample()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Address</th>
      <th>Location</th>
      <th>MinPrice</th>
      <th>MaxPrice</th>
      <th>Currency</th>
      <th>Cuisine</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>PhoneNumber</th>
      <th>Url</th>
      <th>WebsiteUrl</th>
      <th>Award</th>
      <th>FacilitiesAndServices</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1157</th>
      <td>Maximin Hellio</td>
      <td>64 rue Gambetta, Deauville, 14800, France</td>
      <td>Deauville</td>
      <td>48</td>
      <td>120</td>
      <td>EUR</td>
      <td>Modern Cuisine</td>
      <td>0.077085</td>
      <td>49.359282</td>
      <td>3.323149e+10</td>
      <td>https://guide.michelin.com/en/normandie/deauvi...</td>
      <td>https://www.maximinhellio.fr/</td>
      <td>1 MICHELIN Star</td>
      <td>Air conditioning,American Express credit card,...</td>
    </tr>
  </tbody>
</table>
</div>




```python
# top 20?
cuisine_20 = michelin.groupby('Cuisine', as_index=False).count()[['Cuisine', 'Name']].sort_values('Name', ascending = False).head(20)
```


```python
fig = plt.figure(figsize=(10, 7))
sns.barplot(x = 'Cuisine',
            y = 'Name',
    data = cuisine_20);

plt.xticks(rotation=90, horizontalalignment="center");
```


    
![png](output_9_0.png)
    


#### Modern Cuisine


```python
# modern?
```


```python
modern_michelin = michelin[michelin['Cuisine'] == 'Modern Cuisine']
```


```python
modern_michelin.groupby('Location', as_index = False).count()[['Location', 'Name']].sort_values('Name', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>481</th>
      <td>Paris</td>
      <td>71</td>
    </tr>
    <tr>
      <th>374</th>
      <td>London</td>
      <td>17</td>
    </tr>
    <tr>
      <th>382</th>
      <td>Lyon</td>
      <td>13</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Clermont-Ferrand</td>
      <td>9</td>
    </tr>
    <tr>
      <th>203</th>
      <td>Dijon</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>



According to the Michelin guide, Modern cuisine

#### Creative


```python
creative_michelin = michelin[michelin['Cuisine'] == 'Creative']
```


```python
creative_michelin.groupby('Location', as_index = False).count()[['Location', 'Name']].sort_values('Name', ascending = False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>204</th>
      <td>Paris</td>
      <td>29</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Barcelona</td>
      <td>10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Amsterdam</td>
      <td>8</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Lyon</td>
      <td>8</td>
    </tr>
    <tr>
      <th>160</th>
      <td>Madrid</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



#### Traditional 


```python
michelin[michelin['Cuisine'] == 'Traditional Cuisine'].groupby('Location').count().sort_values('Name', ascending = False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Address</th>
      <th>MinPrice</th>
      <th>MaxPrice</th>
      <th>Currency</th>
      <th>Cuisine</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>PhoneNumber</th>
      <th>Url</th>
      <th>WebsiteUrl</th>
      <th>Award</th>
      <th>FacilitiesAndServices</th>
    </tr>
    <tr>
      <th>Location</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Paris</th>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Madrid</th>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Prague</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Logrono</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Cambrils</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Gambarie</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Gasny</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Gevrey-Chambertin</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Grignan</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Ã‰vian-les-Bains</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>204 rows Ã— 13 columns</p>
</div>




```python
michelin[michelin['Cuisine'] == 'Traditional Cuisine'].groupby('Location')
```




    <pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f9a4bec3b50>



### Geographies


```python
# geographies
```


```python
cities_mich_top = michelin.groupby('Location', as_index = False).count().sort_values(by = 'Name', ascending=False).head(20)
```


```python
fig = plt.figure(figsize=(10, 7))
sns.barplot(x = 'Location',
            y = 'Name',
    data = cities_mich_top);

plt.xticks(rotation=90, horizontalalignment="center");
```


    
![png](output_24_0.png)
    



```python
cities_mich_top['Proportion'] = cities_mich_top['Name']/6527
```


```python
fig = plt.figure(figsize=(10, 7))
sns.barplot(x = 'Location',
            y = 'Proportion',
    data = cities_mich_top);

plt.xticks(rotation=90, horizontalalignment="center");
```


    
![png](output_26_0.png)
    


### Tokyo

Most Michelin-starred restaurants are in Tokyo, followed by Osaka and Kyoto. 


```python
tokyo_michelin = michelin[michelin['Location'] == 'Tokyo']
```


```python
tokyo_michelin_geo = gpd.GeoDataFrame(
    tokyo_michelin, geometry=gpd.points_from_xy(tokyo_michelin.Longitude, tokyo_michelin.Latitude))
```


```python
tokyo_michelin_geo.crs = "EPSG:4326"
tokyo_michelin_geo = tokyo_michelin_geo.to_crs(epsg=3857)
```


```python
fig, ax = plt.subplots(figsize=(15,15))
tokyo_michelin_geo.plot(column = 'Cuisine', legend = True, ax = ax)
cx.add_basemap(ax)
plt.savefig("tokyo.png")
```


    
![png](output_32_0.png)
    



```python
# elaborate on interesting things

# places with 3 stars

tokyo_3 = tokyo_michelin_geo[tokyo_michelin_geo['Award'] == '3 MICHELIN Stars']
fig, ax = plt.subplots(figsize=(15,15))
tokyo_3.plot(column = 'Cuisine', legend = True, ax = ax)
cx.add_basemap(ax)
plt.savefig("tokyo_three.png")
```


    
![png](output_33_0.png)
    


### World


```python
# plot michelins around the world

mich_geo = gpd.GeoDataFrame(
    michelin, geometry=gpd.points_from_xy(michelin.Longitude, michelin.Latitude))
mich_geo.crs = "EPSG:4326"
mich_geo = mich_geo.to_crs(epsg=3857)

fig, ax = plt.subplots(figsize=(15,15))
mich_geo.plot(ax = ax, markersize=1)
cx.add_basemap(ax, source=cx.providers.Stamen.TonerLite)
```


    
![png](output_35_0.png)
    


### Other metrics


```python
mich_geo = michelin.dropna()
```


```python
# number of stars
```


```python
# price
```


```python
mich_geo['MinPrice'] = mich_geo['MinPrice'].str.replace(',','')
```

    /var/folders/__/8q6wtgc10gsdhs_z1lv_0r700000gn/T/ipykernel_1386/1386935603.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      mich_geo['MinPrice'] = mich_geo['MinPrice'].str.replace(',','')



```python
mich_geo['MinPrice'] = mich_geo['MinPrice'].map(lambda x: int(x))
mich_geo['MaxPrice'] = mich_geo['MaxPrice'].str.replace(',','')
mich_geo['MaxPrice'] = mich_geo['MaxPrice'].map(lambda x: int(x))
```

    /var/folders/__/8q6wtgc10gsdhs_z1lv_0r700000gn/T/ipykernel_1386/5376245.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      mich_geo['MinPrice'] = mich_geo['MinPrice'].map(lambda x: int(x))
    /var/folders/__/8q6wtgc10gsdhs_z1lv_0r700000gn/T/ipykernel_1386/5376245.py:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      mich_geo['MaxPrice'] = mich_geo['MaxPrice'].str.replace(',','')
    /var/folders/__/8q6wtgc10gsdhs_z1lv_0r700000gn/T/ipykernel_1386/5376245.py:3: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      mich_geo['MaxPrice'] = mich_geo['MaxPrice'].map(lambda x: int(x))



```python
# which is the most affordable place to eat in michelin restaurants

# city with lowest average max price across all its restaurants

# use currency converter

c = CurrencyConverter()
```


```python
mich_geo_currencies = mich_geo[(mich_geo['Currency'] != 'MOP') & 
                   (mich_geo['Currency'] != 'TWD') & 
                   (mich_geo['Currency'] != 'AED') &
                   (mich_geo['Currency'] != 'RSD')]
```


```python
mich_geo_currencies['MaxPriceUSD'] = mich_geo_currencies.apply(lambda x: c.convert(x['MaxPrice'], x['Currency'], 'USD'), axis = 1)
```

    /var/folders/__/8q6wtgc10gsdhs_z1lv_0r700000gn/T/ipykernel_1386/2301009810.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      mich_geo_currencies['MaxPriceUSD'] = mich_geo_currencies.apply(lambda x: c.convert(x['MaxPrice'], x['Currency'], 'USD'), axis = 1)



```python
mich_geo_currencies.sort_values(['MaxPriceUSD'], ascending = False).iloc[0,:]
```




    Name                                                               L'Ã‰crin
    Address                  Le Crillon, 10 place de la Concorde, Paris, 75...
    Location                                                             Paris
    MinPrice                                                               175
    MaxPrice                                                               735
    Currency                                                               EUR
    Cuisine                                                           Creative
    Longitude                                                         2.321069
    Latitude                                                          48.86699
    PhoneNumber                                                  33144711517.0
    Url                      https://guide.michelin.com/en/ile-de-france/pa...
    WebsiteUrl               https://www.rosewoodhotels.com/fr/hotel-de-cri...
    Award                                                      1 MICHELIN Star
    FacilitiesAndServices    Air conditioning,American Express credit card,...
    MaxPriceUSD                                                       744.6285
    Name: 1063, dtype: object




```python
price_loc = mich_geo_currencies.groupby('Location', as_index = False).mean().sort_values('MaxPriceUSD', ascending = False).head(20)[['Location', 'MaxPriceUSD']]
```


```python
fig = plt.figure(figsize=(10, 7))
sns.barplot(x = 'Location',
            y = 'MaxPriceUSD',
    data = price_loc);

plt.xticks(rotation=90, horizontalalignment="center");
```


    
![png](output_47_0.png)
    



```python
# by cuisine
```


```python
cuis_price = mich_geo_currencies.groupby('Cuisine', as_index = False).mean().sort_values('MaxPriceUSD', ascending = False).head(15)[['Cuisine', 'MaxPriceUSD']]
```


```python
fig = plt.figure(figsize=(10, 7))
sns.barplot(x = 'Cuisine',
            y = 'MaxPriceUSD',
    data = cuis_price);

plt.xticks(rotation=90, horizontalalignment="center");
```


    
![png](output_50_0.png)
    



```python

```
